<?xml version="1.0" encoding="UTF-8"?>
<Module>

  <ModulePrefs
        title="map-gadget"
        height="410"
        scaling="false" />
  <Require feature="dynamic-height"/>
  <UserPref name="_table_query_url"
        display_name="Data source url"
        required="true"/>
  
  <UserPref name="_table_query_refresh_interval"
        display_name="Data refresh interval (minutes)"
    default_value="0"
        datatype="enum"
        required="false">
    <EnumValue value="0"
          display_value="Do not refresh"/>
    <EnumValue value="60"
          display_value="1"/>
    <EnumValue value="300"
          display_value="5"/>
    <EnumValue value="1800"
          display_value="30"/>
  </UserPref>

  <Content type="html">
  <![CDATA[
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script type="text/javascript">
    function initialize() {
      var prefs = new gadgets.Prefs();
      
      // Use this URL: https://docs.google.com/spreadsheets/d/1TyznJnhk1lDg8msI8oQzSrY8oZpySyh6kCmnlQMGuAc/gviz/tq?range=A1:D1000
      var query = new google.visualization.Query(prefs.getString('https://docs.google.com/spreadsheets/d/1TyznJnhk1lDg8msI8oQzSrY8oZpySyh6kCmnlQMGuAc/gviz/tq?range=A1:D1000'),
                                                                 {sendMethod: 'auto'});
      query.setRefreshInterval(60);
      query.send(handleQueryResponse);
    }
    
    function handleQueryResponse(response) {
      var data = response.getDataTable();
      var route = data.getValue(data.getNumberOfRows() - 1, 3)
      var route = "https://mapsengine.google.com/11689989258151602055-17772055697785505571-4/mapview/?authuser=0"
    }
  </script>
  <img src="https://www.google.com/chart?chc=sites&amp;cht=d&amp;chdp=sites&amp;chl=%5B%5BGoogle+Gadget'%3D20'f%5Cv'a%5C%3D0'10'%3D499'0'dim'%5Cbox1'b%5CF6F6F6'fC%5CF6F6F6'eC%5C0'sk'%5C%5B%22Include+gadget+(iframe)%22'%5D'a%5CV%5C%3D12'f%5C%5DV%5Cta%5C%3D10'%3D0'%3D500'%3D797'dim'%5C%3D10'%3D10'%3D500'%3D797'vdim'%5Cbox1'b%5Cva%5CF6F6F6'fC%5CC8C8C8'eC%5C'a%5C%5Do%5CLauto'f%5C&amp;sig=LIupg-AjxUbah_DqtRj3JecPeDg" data-igsrc="http://158.gmodules.com/ig/ifr?mid=158&amp;synd=trogedit&amp;url=http%3A%2F%2Fhosting.gmodules.com%2Fig%2Fgadgets%2Ffile%2F106581606564100174314%2Fiframe.xml&amp;up_iframeURL=https%3A%2F%2Fmapsengine.google.com%2F11689989258151602055-17772055697785505571-4%2Fmapview%2F%3Fauthuser%3D0&amp;up_scroll=no&amp;h=800&amp;w=100%25" data-type="ggs-gadget" data-props="align:center;borderTitle:Include gadget (iframe);height:800;igsrc:http#58//158.gmodules.com/ig/ifr?mid=158&amp;synd=trogedit&amp;url=http%3A%2F%2Fhosting.gmodules.com%2Fig%2Fgadgets%2Ffile%2F106581606564100174314%2Fiframe.xml&amp;up_iframeURL=https%3A%2F%2Fmapsengine.google.com%2F11689989258151602055-17772055697785505571-4%2Fmapview%2F%3Fauthuser%3D0&amp;up_scroll=no&amp;h=800&amp;w=100%25;mid:158;scrolling:no;showBorder:true;showBorderTitle:null;spec:http#58//hosting.gmodules.com/ig/gadgets/file/106581606564100174314/iframe.xml;up_iframeURL:" + route + ";up_scroll:no;view:canvas;width:100%;wrap:false;" width="500" height="800" style="display:block;margin:5px auto;text-align:center;" class="igm">
  <div></div>
    
    
      
  <div></div>

  ]]>
  </Content>
</Module>