<?xml version="1.0" encoding="UTF-8"?>
<Module>

  <ModulePrefs
        title="map-gadget"
        height="410"
        scaling="false" />
  <Require feature="dynamic-height"/>
  <UserPref name="_table_query_url"
        display_name="Data source url"
        required="true"/>
  
  <UserPref name="_table_query_refresh_interval"
        display_name="Data refresh interval (minutes)"
    default_value="0"
        datatype="enum"
        required="false">
    <EnumValue value="0"
          display_value="Do not refresh"/>
    <EnumValue value="60"
          display_value="1"/>
    <EnumValue value="300"
          display_value="5"/>
    <EnumValue value="1800"
          display_value="30"/>
  </UserPref>

  <Content type="html">
  <![CDATA[
  <div id="map-canvas"></div>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=visualization"></script>
    <script type="text/javascript">
      function initialize() {

        var fillArray = ['red', 'blue', 'yellow', 'green'];

        var mapOptions = {
          zoom: 14,
          center: new google.maps.LatLng(59.322506, 18.010025)
        };

        var map = new google.maps.Map(document.getElementById('map-canvas'),
          mapOptions);

        var layer = new google.maps.visualization.DynamicMapsEngineLayer({
          layerId: '06673056454046135537-08896501997766553811',
          map: map,
          suppressInfoWindows: true,
          clickable: true
        });

        google.maps.event.addListener(layer, 'mouseover', function(event) {
          var style = layer.getFeatureStyle(event.featureId);
          style.fillColor = fillArray[event.featureId - 1];
          style.fillOpacity = '0.8';
        });

        google.maps.event.addListener(layer, 'mouseout', function(event) {
          var style = layer.getFeatureStyle(event.featureId).resetAll();
        });
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  ]]>
  </Content>
</Module>