<!-- Element to hold the chart -->
<div id="tablediv" style="overflow: auto;">Loading...</div>

<script>
  var table = null;
  _IG_RegisterOnloadHandler(loadVisualizationAPI);

  function loadVisualizationAPI() {
    google.load('visualization', '1', {'packages': ['table']});
    google.setOnLoadCallback(sendQuery);
  }

  function sendQuery() {
    // Get a handle to the host element and instantiate your chart.
    // _gel() is identical to getElementById(). Use either.
    var tableDiv = _gel('tablediv');
    table = new google.visualization.Table(tableDiv);

    gadgetHelper = new google.visualization.GadgetHelper();
    var query = gadgetHelper.createQueryFromPrefs(prefs);
    query.send(handleQueryResponse);
  }

  function handleQueryResponse(response) {
    // Use the chart GadgetHelper class to validate the data, and
    // for error handling.
    if (!gadgetHelper.validateResponse(response)) {
      // Default error handling was done, just leave.
      return;
    };
    var data = response.getDataTable();

    // Take the data table from the response, and format it.
    var options = {showRowNumber: true};

    table.draw(data, options);
  };

</script>